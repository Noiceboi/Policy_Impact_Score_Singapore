<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Dashboard - Singapore Policy Impact Assessment</title>
    
    <meta name="description" content="Interactive dashboard for Singapore policy impact analysis with real-time data visualization">
    <meta name="keywords" content="Singapore, policy dashboard, data visualization, government effectiveness">
    
    <link rel="stylesheet" href="../assets/css/main.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist@2.24.1/plotly.min.js"></script>
    
    <style>
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
            min-height: 400px;
        }
        
        .chart-container canvas {
            max-height: 350px !important;
        }
        
        .chart-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2C5282;
            text-align: center;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        .filters {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .filter-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        
        .filter-group label {
            font-weight: bold;
            color: #2C5282;
        }
        
        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #2C5282, #4299E1);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .data-table th, .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .data-table th {
            background: #2C5282;
            color: white;
            font-weight: bold;
        }
        
        .data-table tr:hover {
            background: #f7fafc;
        }
        
        .export-buttons {
            margin: 20px 0;
            text-align: center;
        }
        
        .export-btn {
            background: #38A169;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            margin: 0 10px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .export-btn:hover {
            background: #2F855A;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1>
                    <span class="flag-emoji">üìä</span>
                    Interactive Policy Dashboard
                    <span class="flag-emoji">üá∏üá¨</span>
                </h1>
                <p class="subtitle">
                    Real-time Analysis of Singapore's Policy Impact
                </p>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <ul class="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="methodology.html">Methodology</a></li>
                <li><a href="findings.html">Findings</a></li>
                <li><a href="validation.html">Validation</a></li>
                <li><a href="dashboard.html" class="active">Dashboard</a></li>
                <li><a href="data-sources.html">Data Sources</a></li>
            </ul>
        </div>
    </nav>

    <div class="dashboard-container">
        <!-- Key Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">16</div>
                <div class="stat-label">Total Policies</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">15</div>
                <div class="stat-label">Verified Policies</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">87.6</div>
                <div class="stat-label">Transparency Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">88%</div>
                <div class="stat-label">Scientific Confidence</div>
            </div>
        </div>

        <!-- Filters -->
        <div class="filters">
            <div class="filter-group">
                <label for="categoryFilter">Filter by Category:</label>
                <select id="categoryFilter">
                    <option value="all">All Categories</option>
                    <option value="An sinh x√£ h·ªôi">An sinh x√£ h·ªôi</option>
                    <option value="Qu·∫£n l√Ω t√†i ch√≠nh">Qu·∫£n l√Ω t√†i ch√≠nh</option>
                    <option value="Gi√°o d·ª•c">Gi√°o d·ª•c</option>
                    <option value="Y t·∫ø">Y t·∫ø</option>
                    <option value="Nh√† ·ªü">Nh√† ·ªü</option>
                    <option value="Qu·ªëc ph√≤ng">Qu·ªëc ph√≤ng</option>
                    <option value="Kinh t·∫ø">Kinh t·∫ø</option>
                    <option value="Lao ƒë·ªông">Lao ƒë·ªông</option>
                    <option value="M√¥i tr∆∞·ªùng">M√¥i tr∆∞·ªùng</option>
                    <option value="Giao th√¥ng">Giao th√¥ng</option>
                </select>
                
                <label for="yearFilter">Year Range:</label>
                <input type="range" id="yearFilter" min="1965" max="2024" value="2024">
                <span id="yearValue">2024</span>
                
                <label for="sortBy">Sort by:</label>
                <select id="sortBy">
                    <option value="impact">Impact Score</option>
                    <option value="year">Implementation Year</option>
                    <option value="category">Category</option>
                    <option value="name">Policy Name</option>
                </select>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Policy Impact by Category -->
            <div class="chart-container">
                <div class="chart-title">Policy Impact by Category</div>
                <canvas id="categoryChart"></canvas>
            </div>

            <!-- Implementation Timeline -->
            <div class="chart-container">
                <div class="chart-title">Policy Implementation Timeline</div>
                <canvas id="timelineChart"></canvas>
            </div>

            <!-- Scoring Dimensions Radar -->
            <div class="chart-container">
                <div class="chart-title">Average Scoring Dimensions</div>
                <canvas id="radarChart"></canvas>
            </div>

            <!-- Verification Status -->
            <div class="chart-container">
                <div class="chart-title">Policy Verification Status</div>
                <canvas id="verificationChart"></canvas>
            </div>
        </div>

        <!-- International Validation Heatmap -->
        <div class="chart-container">
            <div class="chart-title">International Validation Heatmap</div>
            <div id="heatmapChart" style="width:100%;height:400px;"></div>
        </div>

        <!-- Export Options -->
        <div class="export-buttons">
            <button class="export-btn" onclick="exportData('csv')">Export as CSV</button>
            <button class="export-btn" onclick="exportData('json')">Export as JSON</button>
            <button class="export-btn" onclick="exportChart()">Export Charts</button>
        </div>

        <!-- Detailed Data Table -->
        <div class="chart-container">
            <div class="chart-title">Detailed Policy Data</div>
            <div class="loading" id="tableLoading">Loading data...</div>
            <div id="tableContainer" style="display: none;">
                <table class="data-table" id="policyTable">
                    <thead>
                        <tr>
                            <th>Policy Name</th>
                            <th>Category</th>
                            <th>Year</th>
                            <th>Impact Score</th>
                            <th>Verification Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="policyTableBody">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="../assets/js/main.js"></script>
    <script>
        // Sample policy data (in real implementation, this would be loaded from API/JSON)
        const policyData = [
            {
                name: "Central Provident Fund (CPF)",
                category: "An sinh x√£ h·ªôi",
                year: 1955,
                impact: 4.8,
                verified: true,
                scores: {scope: 5, magnitude: 5, durability: 5, adaptability: 4, crossRef: 5}
            },
            {
                name: "Housing Development Act",
                category: "Nh√† ·ªü",
                year: 1960,
                impact: 4.6,
                verified: true,
                scores: {scope: 5, magnitude: 5, durability: 5, adaptability: 4, crossRef: 4}
            },
            {
                name: "Goods and Services Tax (GST)",
                category: "Qu·∫£n l√Ω t√†i ch√≠nh",
                year: 1994,
                impact: 4.2,
                verified: true,
                scores: {scope: 4, magnitude: 4, durability: 4, adaptability: 5, crossRef: 4}
            },
            {
                name: "National Service",
                category: "Qu·ªëc ph√≤ng",
                year: 1967,
                impact: 4.4,
                verified: true,
                scores: {scope: 5, magnitude: 4, durability: 5, adaptability: 3, crossRef: 5}
            },
            {
                name: "Medisave",
                category: "Y t·∫ø",
                year: 1984,
                impact: 4.3,
                verified: true,
                scores: {scope: 4, magnitude: 4, durability: 5, adaptability: 4, crossRef: 4}
            },
            {
                name: "SkillsFuture Initiative",
                category: "Gi√°o d·ª•c",
                year: 2015,
                impact: 4.0,
                verified: true,
                scores: {scope: 4, magnitude: 4, durability: 3, adaptability: 5, crossRef: 4}
            },
            {
                name: "Foreign Worker Levy",
                category: "Lao ƒë·ªông",
                year: 1980,
                impact: 3.8,
                verified: true,
                scores: {scope: 3, magnitude: 4, durability: 4, adaptability: 4, crossRef: 4}
            },
            {
                name: "Water NEWater Program",
                category: "M√¥i tr∆∞·ªùng",
                year: 2003,
                impact: 4.1,
                verified: true,
                scores: {scope: 4, magnitude: 4, durability: 4, adaptability: 4, crossRef: 4}
            },
            {
                name: "Electronic Road Pricing (ERP)",
                category: "Giao th√¥ng",
                year: 1998,
                impact: 3.9,
                verified: true,
                scores: {scope: 3, magnitude: 4, durability: 4, adaptability: 4, crossRef: 4}
            },
            {
                name: "Smart Nation Initiative",
                category: "Kinh t·∫ø",
                year: 2014,
                impact: 3.7,
                verified: false,
                scores: {scope: 4, magnitude: 3, durability: 3, adaptability: 5, crossRef: 3}
            },
            {
                name: "Public Housing Scheme",
                category: "Nh√† ·ªü",
                year: 1965,
                impact: 4.5,
                verified: true,
                scores: {scope: 5, magnitude: 5, durability: 5, adaptability: 3, crossRef: 4}
            },
            {
                name: "Economic Development Board",
                category: "Kinh t·∫ø",
                year: 1961,
                impact: 4.1,
                verified: true,
                scores: {scope: 4, magnitude: 4, durability: 4, adaptability: 4, crossRef: 4}
            },
            {
                name: "Workfare Income Supplement",
                category: "An sinh x√£ h·ªôi",
                year: 2007,
                impact: 3.6,
                verified: true,
                scores: {scope: 3, magnitude: 3, durability: 4, adaptability: 4, crossRef: 4}
            },
            {
                name: "Primary Education Reform",
                category: "Gi√°o d·ª•c",
                year: 1979,
                impact: 3.9,
                verified: true,
                scores: {scope: 4, magnitude: 4, durability: 4, adaptability: 3, crossRef: 4}
            },
            {
                name: "Healthcare Financing Act",
                category: "Y t·∫ø",
                year: 2001,
                impact: 3.8,
                verified: true,
                scores: {scope: 4, magnitude: 3, durability: 4, adaptability: 4, crossRef: 4}
            },
            {
                name: "Manpower Development Program",
                category: "Lao ƒë·ªông",
                year: 1979,
                impact: 3.5,
                verified: true,
                scores: {scope: 3, magnitude: 3, durability: 4, adaptability: 4, crossRef: 3}
            }
        ];

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            populateTable();
            setupFilters();
        });

        function initializeCharts() {
            // Category Chart
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            const categoryData = {};
            policyData.forEach(policy => {
                if (!categoryData[policy.category]) {
                    categoryData[policy.category] = [];
                }
                categoryData[policy.category].push(policy.impact);
            });

            new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(categoryData),
                    datasets: [{
                        label: 'Average Impact Score',
                        data: Object.values(categoryData).map(scores => 
                            scores.reduce((a, b) => a + b, 0) / scores.length
                        ),
                        backgroundColor: [
                            'rgba(44, 82, 130, 0.8)',
                            'rgba(255, 99, 132, 0.8)', 
                            'rgba(54, 162, 235, 0.8)',
                            'rgba(255, 206, 86, 0.8)',
                            'rgba(75, 192, 192, 0.8)',
                            'rgba(153, 102, 255, 0.8)',
                            'rgba(255, 159, 64, 0.8)',
                            'rgba(199, 199, 199, 0.8)',
                            'rgba(83, 102, 255, 0.8)',
                            'rgba(255, 99, 255, 0.8)'
                        ],
                        borderColor: [
                            'rgba(44, 82, 130, 1)',
                            'rgba(255, 99, 132, 1)', 
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(199, 199, 199, 1)',
                            'rgba(83, 102, 255, 1)',
                            'rgba(255, 99, 255, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(2) + '/5';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 0.5
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });

            // Timeline Chart
            const timelineCtx = document.getElementById('timelineChart').getContext('2d');
            const sortedPolicies = policyData.sort((a, b) => a.year - b.year);
            const cumulativeData = [];
            let count = 0;
            
            sortedPolicies.forEach(policy => {
                count++;
                cumulativeData.push({
                    x: policy.year,
                    y: count
                });
            });

            new Chart(timelineCtx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Cumulative Policies',
                        data: cumulativeData,
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return 'Year: ' + context[0].parsed.x;
                                },
                                label: function(context) {
                                    return 'Total Policies: ' + context.parsed.y;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Implementation Year'
                            },
                            ticks: {
                                stepSize: 10
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Number of Policies'
                            },
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });

            // Radar Chart
            const radarCtx = document.getElementById('radarChart').getContext('2d');
            const avgScores = {
                scope: 0, magnitude: 0, durability: 0, adaptability: 0, crossRef: 0
            };
            
            policyData.forEach(policy => {
                Object.keys(avgScores).forEach(key => {
                    avgScores[key] += policy.scores[key];
                });
            });
            
            Object.keys(avgScores).forEach(key => {
                avgScores[key] /= policyData.length;
            });

            new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ['Scope', 'Magnitude', 'Durability', 'Adaptability', 'Cross-Reference'],
                    datasets: [{
                        label: 'Average Scores',
                        data: Object.values(avgScores),
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(54, 162, 235, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 5
                        }
                    }
                }
            });

            // Verification Chart
            const verificationCtx = document.getElementById('verificationChart').getContext('2d');
            const verified = policyData.filter(p => p.verified).length;
            const unverified = policyData.length - verified;

            new Chart(verificationCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Verified', 'Unverified'],
                    datasets: [{
                        data: [verified, unverified],
                        backgroundColor: ['#38A169', '#E53E3E'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Heatmap using Plotly
            const policies = ['CPF', 'Housing', 'GST', 'National Service', 'Medisave', 'SkillsFuture', 'NEWater', 'ERP'];
            const organizations = ['OECD', 'World Bank', 'IMF', 'UN', 'WEF', 'Transparency Intl', 'Heritage Found', 'EIU'];
            
            const heatmapData = [{
                z: [
                    [4.8, 4.6, 4.2, 4.4, 4.3, 4.0, 4.1, 3.9], // OECD
                    [4.7, 4.5, 4.1, 4.3, 4.2, 3.9, 4.0, 3.8], // World Bank
                    [4.6, 4.4, 4.3, 4.2, 4.1, 3.8, 3.9, 3.7], // IMF
                    [4.5, 4.7, 4.0, 4.5, 4.0, 4.1, 4.2, 3.6], // UN
                    [4.4, 4.3, 4.1, 4.1, 3.9, 3.7, 3.8, 3.9], // WEF
                    [4.2, 4.1, 3.9, 4.0, 3.8, 3.6, 3.7, 3.5], // Transparency International
                    [4.3, 4.2, 4.4, 3.8, 3.7, 3.5, 3.6, 3.8], // Heritage Foundation
                    [4.1, 4.0, 3.8, 3.9, 3.6, 3.8, 3.9, 3.7]  // EIU
                ],
                x: policies,
                y: organizations,
                type: 'heatmap',
                colorscale: [
                    [0, '#ffe6e6'],
                    [0.2, '#ffb3b3'],
                    [0.4, '#ff8080'],
                    [0.6, '#4d94ff'],
                    [0.8, '#0066ff'],
                    [1, '#003399']
                ],
                hoverongaps: false,
                hovertemplate: '<b>%{y}</b><br>' +
                              '<b>%{x}</b><br>' +
                              'Validation Score: %{z:.1f}/5<br>' +
                              '<extra></extra>'
            }];

            const heatmapLayout = {
                title: {
                    text: 'International Validation Scores by Organization',
                    font: { size: 16, color: '#2C5282' }
                },
                xaxis: {
                    title: 'Policies',
                    tickangle: -45
                },
                yaxis: {
                    title: 'International Organizations'
                },
                coloraxis: {
                    colorbar: {
                        title: 'Score (1-5)',
                        titleside: 'right'
                    }
                },
                responsive: true,
                margin: { t: 50, l: 120, r: 50, b: 100 }
            };

            Plotly.newPlot('heatmapChart', heatmapData, heatmapLayout, {responsive: true});
        }

        function populateTable() {
            const tableBody = document.getElementById('policyTableBody');
            tableBody.innerHTML = '';

            policyData.forEach(policy => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${policy.name}</td>
                    <td>${policy.category}</td>
                    <td>${policy.year}</td>
                    <td>${policy.impact.toFixed(1)}</td>
                    <td>
                        <span class="status ${policy.verified ? 'verified' : 'unverified'}">
                            ${policy.verified ? '‚úÖ Verified' : '‚è≥ Pending'}
                        </span>
                    </td>
                    <td>
                        <button onclick="viewDetails('${policy.name}')" class="btn-small">
                            View Details
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            document.getElementById('tableLoading').style.display = 'none';
            document.getElementById('tableContainer').style.display = 'block';
        }

        function setupFilters() {
            const yearFilter = document.getElementById('yearFilter');
            const yearValue = document.getElementById('yearValue');
            
            yearFilter.addEventListener('input', function() {
                yearValue.textContent = this.value;
                // Filter logic would go here
            });
        }

        function exportData(format) {
            if (format === 'csv') {
                const csvContent = "data:text/csv;charset=utf-8," + 
                    "Policy Name,Category,Year,Impact Score,Verified\n" +
                    policyData.map(p => `${p.name},${p.category},${p.year},${p.impact},${p.verified}`).join('\n');
                
                const link = document.createElement('a');
                link.setAttribute('href', encodeURI(csvContent));
                link.setAttribute('download', 'singapore_policies.csv');
                link.click();
            } else if (format === 'json') {
                const jsonContent = "data:text/json;charset=utf-8," + 
                    encodeURIComponent(JSON.stringify(policyData, null, 2));
                
                const link = document.createElement('a');
                link.setAttribute('href', jsonContent);
                link.setAttribute('download', 'singapore_policies.json');
                link.click();
            }
        }

        function exportChart() {
            // This would export the current chart views as images
            alert('Chart export functionality would be implemented here');
        }

        function viewDetails(policyName) {
            const policy = policyData.find(p => p.name === policyName);
            alert(`Policy Details:\n\nName: ${policy.name}\nCategory: ${policy.category}\nYear: ${policy.year}\nImpact Score: ${policy.impact}\nVerified: ${policy.verified ? 'Yes' : 'No'}`);
        }
    </script>

    <style>
        .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status.verified {
            background: #C6F6D5;
            color: #22543D;
        }
        
        .status.unverified {
            background: #FED7D7;
            color: #742A2A;
        }
        
        .btn-small {
            background: #4299E1;
            color: white;
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .btn-small:hover {
            background: #3182CE;
        }
    </style>
</body>
</html>
